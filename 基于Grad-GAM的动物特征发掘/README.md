# 基于Grad-GAM的动物特征发掘

## Grad-GAM介绍

[[1610.02391\] Grad-CAM: Visual Explanations from Deep Networks via Gradient-based Localization (arxiv.org)](https://arxiv.org/abs/1610.02391)是一篇由Selvaraju等人于2017年提出的论文，它提出了Grad-CAM方法，用于从深度神经网络中生成视觉解释。

Grad-CAM旨在解决深度神经网络模型的可解释性问题，即对于给定的图像分类结果，如何确定网络所关注的区域。通过生成热力图，Grad-CAM能够准确地显示网络在做出预测时所重视的图像区域。

具体而言，Grad-CAM利用了梯度信息来定位关注区域。以下是Grad-CAM方法的步骤：

1. 定义目标类别：选择感兴趣的类别，例如“猫”或“汽车”。
2. 进行前向传播：将输入图像通过深度神经网络进行前向传播，获取模型的输出。
3. 计算目标类别的梯度：对目标类别的分数进行反向传播，计算相对于特征图的梯度。
4. 汇总梯度：对梯度进行空间平均，以得到每个特征图通道的权重。
5. 加权求和：将特征图与权重相乘，得到类别特定的激活图。
6. 叠加激活图：将类别特定的激活图与输入图像相叠加，形成Grad-CAM的可视化结果。

通过Grad-CAM生成的热力图，可以直观地显示网络对目标类别的关注程度，即网络认为哪些区域在做出预测时起到了重要作用。这种可视化解释有助于理解深度神经网络的决策过程，并增强模型的可解释性。

Grad-CAM方法在计算机视觉领域被广泛应用，特别是在图像分类、物体检测和图像分割等任务中，在解释模型预测结果方面发挥了重要作用。它提供了一种简单而强大的工具，帮助研究人员和从业者更好地理解深度神经网络的内部运作。

## 项目思路

复现Grad-GAM方法，发掘在Imagenet上训练的Xception模型中所学习到的动物分类知识，这些知识可以以热力图的可视化方式教给没有动物知识的人类。这种思想具有强大的工程应用潜力，可以由machine learning转变为machine teaching，甚至可以发掘人类发现不到的专业知识。

## 运行结果

本项目用象类和鲨鱼类动物的图片为例，发掘不同物种间的动物特征。

### 象类特征发掘

![图像-1692281362174](pictures\图像-1692281362174.png)

**左边两图是非洲象的图片，右边两图的亚洲象的图片**，模型在分类时均正确分类，应用Grad-GAM方法可以发现，模型的关注点在大象耳朵和象牙处。尤其是亚洲象的两种图片，几乎把全部重点放在耳朵上，可见耳朵的形状、大小是识别亚洲象的关键特征。

在网上查询非洲象和亚洲象的区别如下，与Grad-CAM发现的特征基本符合。

![就在今天，你可以拯救一头大象。](pictures\R-C.b685bd9f19db87d268fe6aa6bff74965)

### 鲨鱼类特征发掘

![图像-1692282085422](pictures\图像-1692282085422.png)

**第1、2列图片是锤头鲨，第3、4列图片是大白鲨，第5、6列图片是虎鲨。**

从热力图中我们可以直观的发现这三类鲨鱼的差异：锤头鲨的头部和眼睛的位置非常特殊；大白鲨的背部是灰色，腹部是白色；虎鲨有不规则的类似虎皮的条纹。

以下是网上查询到的区分大白鲨、虎鲨和锤头鲨的方法，与Grad-GAM发现的特征相似。

1. 大白鲨（Great White Shark）：
   - 外观特征：身体呈流线型，背部呈灰色或蓝灰色，腹部为白色。
   - 特征标识：具有锐利的三角形齿，上颌齿大而突出，下颌齿较小。
   - 头部形状：头部较宽且圆锥状，眼睛相对较小。
2. 虎鲨（Tiger Shark）：
   - 外观特征：背部颜色灰暗或棕黄色，侧面有不规则的暗色条纹。
   - 特征标识：具有锐利的三角形齿，上下颌齿相对较大。
   - 头部形状：头部较宽，眼睛相对较大。
3. 锤头鲨（Hammerhead Shark）：
   - 外观特征：头部扁平而宽大，呈锤头状，背部为灰褐色。
   - 特征标识：具有锐利的三角形齿，上下颌齿相对较小。
   - 头部形状：头部宽而扁平，眼睛位于头部两侧的突出部分。

## 项目总结

Grad-GAM帮助研究人员和从业者更好地理解深度神经网络的内部运作。然而，Grad-GAM不仅在解释模型预测结果方面发挥了重要作用，还可以反过来将学到的知识教授给人类，**由machine learning转变为machine teaching**，这一想法非常具有潜力，有可能在未来**改变人类的学习方式**。下面是一个例子：2021年深度学习在哪些应用上有实质进展？ - 波尔德的回答 - 知乎 https://www.zhihu.com/question/464195262/answer/1989106429。